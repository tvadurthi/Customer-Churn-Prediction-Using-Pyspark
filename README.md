# Customer-Churn-Prediction-Using-Pyspark
**Problem Statement:**
Customer churn is one of the most critical issues faced by the telecommunications industry. It is more expensive to acquire a new customer as compared to retaining the current one. Hence, customer churn prediction is currently the main mechanism employed by the industry in order to prevent customers from churning. The objective of churn prediction is to identify customers that are going to leave the telecommunications service provider in advance. Customer churn prediction would allow the telecommunications service provider to plan their customer retention strategy. The high volume of data generated by the industry, with the help of data mining techniques implementation, becomes the main asset for predicting customer churn. 
Modern businesses nowadays employ complex algorithms to predict customers that are most likely to churn, i.e. move away from the company. By using such algorithms, companies can know in advance the customers that are most likely to give up the company’s services and therefore, come up with customer retention strategies to mitigate the losses that the company might face.

**Statistics:-**
❖	Annual Average churn rate- 10%-67%
❖	40 % customers wouldn't have switched if they had better plans 
❖	79% of customers admitted sharing their disappointment about the telco’s level of service with other


**Dataset:**
We will be using the Telco Customer Churn dataset. It consists of 7043 rows, where each row represents a customer. There are 21 attributes or features (columns) for each customer. This dataset is available on Kaggle. The target variable in our scenario is the churn (Yes/ No). Out of all the 7043 records, 1869 records correspond to churn (yes) and 5174 records correspond to churn (No). Only 2 features are continuous. The rest 19 are categorical. The attributes or the features are as follow:

⮚	Customer ID: A unique ID assigned to each customer.
⮚	Gender: Indicates the gender of the customer. The two types are Male and Female.
⮚	Senior Citizen (0/ 1): Indicates if the customer is a senior citizen or not. 1 indicates a ‘Yes’ and 0 indicates ‘No’.
⮚	Partner (Yes/ No): Indicates if the customer has a partner or not. 
⮚	Dependents (Yes/ No): Indicates if the customer has dependents or not. 
⮚	Tenure: Indicates the time in months the customer has been with the telecom company.
⮚	Phone Service: Indicates if the customer has a residential phone service.
⮚	Multiple Lines: Indicates if the customer has multiple residential lines. The three types are ‘No phone service’, ‘No’ and ‘Yes’.
⮚	Internet Service: Indicates the type of internet service the customer has. The three types are DSL, Fiber optic and No.
⮚	Online Security (Yes/ No): Indicates whether the customer has online security or not.
⮚	Online Backup (Yes/ No): Indicates whether the customer has online backup or not.
⮚	Device Protection (Yes/ No): Indicates whether the customer has device protection or not.
⮚	Tech Support (Yes/ No): Indicates whether the customer has tech support or not.
⮚	Streaming TV (Yes/ No):  Indicates whether the customer has a TV streaming feature or not.
⮚	Streaming Movies (Yes/ No): Indicates whether the customer has a movie streaming feature or not.
⮚	Contract: Indicates the contract type the customer has with the telecom company. The types are ‘Month-to-Month’, One year, Two Year.
⮚	Paperless Billing  (Yes/ No): Indicates whether the customer has opted for the paperless billing option or not.
⮚	Payment Method: Indicates the type of payment option the customer has opted for. The types are Electronic Check, Mailed Check, Bank Transfer, Credit Card.
⮚	Monthly Charges: It is a continuous variable. Indicates the monthly expenditure borne by the customer to the telecom service provider.
⮚	TotalCharges: It is a continuous variable. Indicates the total expenditure borne by the customer to the telecom service provider.
⮚	Churn (Yes/ No): Indicates whether the customer left the telecom service provider.


**Methodologies Used:**
Power BI:
We have used an interactive Power BI dashboard and visualization for insights.

Python:-
We build machine learning models to predict customer churn based on our dataset using python.We have used pyspark for data pre processing and model building. The dataset is in tabular excel format. A spark session is initiated and the data is read into a pyspark dataframe in multiline format. The columns are mapped to label indices by the label (string) indexer followed by pipelining before getting encoded. The categorical data is encoded and vectorized using the vector assembler. The final data frame which is used to build and test models consists of the vectorized features along with their labeled index and the encoded target(customer churn) variable. Customer churn ‘Yes’ is encoded as ‘1’ and customer churn ‘No’ is encoded as ‘0’. The dataset is split into a 60:40 train to test ratio. The machine learning algorithms used for building the models are logistic regression and naive bayes. In order to prevent overfit of data in the logistic regression model, a regularization parameter is used. The optimum regularization parameter is chosen by selecting the one with the lowest hold out cross validation error. In the naive bayes model, the multinomial classification is used along with laplace smoothing. The models created make predictions on test data.These predictions are used to evaluate models through metrics such as confusion matrix, accuracy and area under the true positive vs false positive ROC curves. Through these ROC curves, suitable classification threshold values can be selected based on different scenarios.

Naive Bayes:-
It is a classification technique based on Bayes’ Theorem with an assumption of independence among predictors. In simple terms, a Naive Bayes classifier assumes that the presence of a particular feature in a class is unrelated to the presence of any other feature.Naive Bayes model is easy to build and particularly useful for very large data sets. Along with simplicity, Naive Bayes is known to outperform even highly sophisticated classification methods.

Logistic Regression:-
This type of statistical analysis (also known as logit model) is often used for predictive analytics and modeling, and extends to applications in machine learning. In this analytics approach, the dependent variable is finite or categorical: either A or B (binary regression) or a range of finite options A, B, C or D (multinomial regression). It is used in statistical software to understand the relationship between the dependent variable and one or more independent variables by estimating probabilities using a logistic regression equation. This type of analysis can help you predict the likelihood of an event happening or a choice being made

**Results:-**
●	As inferred from different visualizations and graphs that the customer churn rate can be decreased if customers are offered a 2 year contract and the churn rate decreases by 50% when the customer opts multiple lines 
●	People having very high tenure or very less tenure are leaving company 
●	People who don’t have phone services aren’t enjoying other services , so probably the customer is leaving. Here the company can work upon new schemes so that customers can get attracted towards services.
●	There is no issue with monthly billing or method of payment, but maximum customers can't afford a two year subscription , so the company should come up with new schemes and offers.
●	The logistic regression model gives testing accuracy of 92.4% and similar area under the true positive vs false positive ROC curve. This is due to the regularization parameter used. As the train/ test accuracies and AUC are similar, a good model fit is inferred. 
●	The multinomial naive bayes model gives a training and testing accuracy of 61.7% the training and testing accuracies are similar indicating a good model fit. The training and testing AUCs for ROC curves are 0.53.
 
 



